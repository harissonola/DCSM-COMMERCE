{% extends 'base.html.twig' %}

{% block title %}Connexion
{% endblock %}

{% block body %}
	<div
		class="auth-wrapper">
		<!-- Background animé -->
		<div class="auth-bg">
			<div class="gradient"></div>
			<div class="particles"></div>
		</div>

		<div
			class="auth-container">
			<!-- Carte compacte -->
			<div
				class="auth-card">
				<!-- Logo -->
				<div class="auth-logo">
					<img src="https://raw.githubusercontent.com/harissonola/my-cdn/main/img/bactrary-logo.png" alt="Bactrary">
				</div>

				<h1 class="auth-title">Bienvenue</h1>
				<p class="auth-subtitle">Connectez-vous pour accéder à votre espace</p>

				{% if error %}
					<div class="alert-error">
						<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
							<circle cx="12" cy="12" r="10"></circle>
							<line x1="12" y1="8" x2="12" y2="12"></line>
							<line x1="12" y1="16" x2="12.01" y2="16"></line>
						</svg>
						{{ error.messageKey|trans(error.messageData, 'security') }}
					</div>
				{% endif %}

				<!-- Formulaire compact -->
				<form method="post" class="auth-form">
					<div class="input-group">
						<input type="text" id="username" name="username" value="{{ last_username }}" required autofocus placeholder="Email ou nom d'utilisateur">
					</div>

					<div class="input-group">
						<input type="password" id="password" name="password" required placeholder="Mot de passe">
						<button type="button" class="toggle-password">
							<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
								<path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
								<circle cx="12" cy="12" r="3"></circle>
							</svg>
						</button>
					</div>

					<div class="form-options">
						<label class="checkbox-label">
							<input type="checkbox" name="_remember_me" checked>
							<span>Se souvenir de moi</span>
						</label>
						<a href="{{ path('app_forgot_password_request') }}" class="forgot-password">
							Mot de passe oublié ?
						</a>
					</div>

					<input type="hidden" name="_csrf_token" value="{{ csrf_token('authenticate') }}">

					<button type="submit" class="btn-login">
						Se connecter
						<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
							<line x1="5" y1="12" x2="19" y2="12"></line>
							<polyline points="12 5 19 12 12 19"></polyline>
						</svg>
					</button>
				</form>

				<div class="auth-separator">
					<span>ou continuer avec</span>
				</div>

				<a href="{{ path('connect_google_start') }}" class="btn-google">
					<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
						<path d="M21.8 12.2c-.2-1.6-.7-3.1-1.5-4.4-1-1.7-2.5-3-4.3-3.7-1.8-.7-3.8-.8-5.7-.3-1.9.5-3.6 1.6-4.9 3.1-1.3 1.5-2.1 3.4-2.3 5.4-.2 2 .2 4 1.1 5.7.9 1.8 2.3 3.2 4 4.1 1.7.9 3.6 1.3 5.5 1.1 1.9-.2 3.7-.9 5.2-2 1.5-1.1 2.7-2.6 3.4-4.3.7-1.7.9-3.6.7-5.5z"></path>
						<path d="M12 7.7c2.9 0 5.3 2.4 5.3 5.3 0 2.9-2.4 5.3-5.3 5.3-2.9 0-5.3-2.4-5.3-5.3 0-2.9 2.4-5.3 5.3-5.3z"></path>
					</svg>
					Google
				</a>

				<div class="auth-footer">
					Pas de compte ?
					<a href="{{ path('app_register') }}">S'inscrire</a>
				</div>
			</div>
		</div>
	</div>

	<style>:root
	{
		--primary: #6c5ce7;
		--primary-dark: #5649c0;
		--text: #ffffff;
		--text-secondary: #b2b2b2;
		--bg-dark: #0f0f1a;
		--bg-darker: #0a0a12;
		--card-bg: rgba(30, 30, 45, 0.8);
		--input-bg: rgba(45, 45, 65, 0.6);
		--input-border: rgba(255, 255, 255, 0.1);
		--error: #ff6b6b;
	}

	.auth-wrapper {
		min-height: 100vh;
		display: flex;
		align-items: center;
		justify-content: center;
		color: var(--text);
		position: relative;
		overflow: hidden;
		padding: 1rem;
	}

	.auth-bg {
		position: absolute;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		z-index: 0;
	}

	.gradient {
		position: absolute;
		width: 100%;
		height: 100%;
		background: linear-gradient(135deg, var(--bg-darker) 0%, var(--bg-dark) 100%);
	}

	.particles {
		position: absolute;
		width: 100%;
		height: 100%;
		background-image: radial-gradient(circle at 20% 30%, rgba(108, 92, 231, 0.15) 0%, transparent 20%), radial-gradient(circle at 80% 70%, rgba(108, 92, 231, 0.15) 0%, transparent 20%);
		animation: float 15s infinite ease-in-out alternate;
	}

	@keyframes float {
		0% {
			transform: translateY(0) rotate(0deg);
		}
		100% {
			transform: translateY(-20px) rotate(2deg);
		}
	}

	.auth-container {
		width: 100%;
		max-width: 380px;
		position: relative;
		z-index: 1;
	}

	.auth-card {
		background: var(--card-bg);
		backdrop-filter: blur(10px);
		-webkit-backdrop-filter: blur(10px);
		border-radius: 14px;
		padding: 2rem;
		box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
		border: 1px solid var(--input-border);
	}

	.auth-logo {
		text-align: center;
		margin-bottom: 1.5rem;
	}

	.auth-logo img {
		height: 50px;
		filter: drop-shadow(0 0 8px rgba(108, 92, 231, 0.4));
	}

	.auth-title {
		font-size: 1.5rem;
		text-align: center;
		margin-bottom: 0.5rem;
		font-weight: 600;
	}

	.auth-subtitle {
		color: var(--text-secondary);
		text-align: center;
		margin-bottom: 1.5rem;
		font-size: 0.95rem;
	}

	.alert-error {
		display: flex;
		align-items: center;
		gap: 0.5rem;
		background: rgba(255, 107, 107, 0.15);
		color: var(--error);
		padding: 0.75rem;
		border-radius: 8px;
		margin-bottom: 1.5rem;
		font-size: 0.9rem;
		border-left: 3px solid var(--error);
	}

	.input-group {
		position: relative;
		margin-bottom: 1rem;
	}

	.input-group input {
		width: 100%;
		padding: 0.875rem 1rem;
		background: var(--input-bg);
		border: 1px solid var(--input-border);
		border-radius: 8px;
		color: var(--text);
		font-size: 0.95rem;
		transition: all 0.3s ease;
	}

	.input-group input:focus {
		outline: none;
		border-color: var(--primary);
		box-shadow: 0 0 0 2px rgba(108, 92, 231, 0.3);
	}

	.input-group input::placeholder {
		color: var(--text-secondary);
	}

	.toggle-password {
		position: absolute;
		right: 12px;
		top: 50%;
		transform: translateY(-50%);
		background: none;
		border: none;
		color: var(--text-secondary);
		cursor: pointer;
	}

	.form-options {
		display: flex;
		justify-content: space-between;
		align-items: center;
		margin: 1rem 0 1.5rem;
		font-size: 0.9rem;
	}

	.checkbox-label {
		display: flex;
		align-items: center;
		gap: 0.5rem;
		color: var(--text-secondary);
		cursor: pointer;
	}

	.checkbox-label input {
		accent-color: var(--primary);
	}

	.forgot-password {
		color: var(--primary);
		text-decoration: none;
		transition: color 0.2s;
	}

	.forgot-password:hover {
		color: var(--primary-dark);
		text-decoration: underline;
	}

	.btn-login {
		width: 100%;
		padding: 0.875rem;
		background: var(--primary);
		color: white;
		border: none;
		border-radius: 8px;
		font-size: 1rem;
		font-weight: 500;
		cursor: pointer;
		transition: all 0.3s ease;
		display: flex;
		align-items: center;
		justify-content: center;
		gap: 0.5rem;
		margin-bottom: 1.5rem;
	}

	.btn-login:hover {
		background: var(--primary-dark);
		transform: translateY(-2px);
		box-shadow: 0 5px 15px rgba(108, 92, 231, 0.3);
	}

	.auth-separator {
		position: relative;
		margin: 1.5rem 0;
		color: var(--text-secondary);
		font-size: 0.85rem;
		text-align: center;
	}

	.auth-separator::before,
	.auth-separator::after {
		content: "";
		position: absolute;
		top: 50%;
		width: 30%;
		height: 1px;
		background: linear-gradient(90deg, transparent, var(--input-border), transparent);
	}

	.auth-separator::before {
		left: 0;
	}

	.auth-separator::after {
		right: 0;
	}

	.btn-google {
		display: flex;
		align-items: center;
		justify-content: center;
		gap: 0.5rem;
		width: 100%;
		padding: 0.75rem;
		background: var(--input-bg);
		color: var(--text);
		border: 1px solid var(--input-border);
		border-radius: 8px;
		font-size: 0.95rem;
		font-weight: 500;
		cursor: pointer;
		transition: all 0.3s ease;
		margin-bottom: 1.5rem;
		text-decoration: none;
	}

	.btn-google:hover {
		background: rgba(45, 45, 65, 0.8);
		transform: translateY(-2px);
	}

	.auth-footer {
		text-align: center;
		color: var(--text-secondary);
		font-size: 0.9rem;
	}

	.auth-footer a {
		color: var(--primary);
		text-decoration: none;
		font-weight: 500;
		transition: color 0.2s;
	}

	.auth-footer a:hover {
		color: var(--primary-dark);
		text-decoration: underline;
	}

	@media(max-width: 480px) {
		.auth-card {
			padding: 1.5rem;
		}

		.auth-title {
			font-size: 1.3rem;
		}
	}
</style>

 <script>
  // Toggle password visibility
  document.querySelector('.toggle-password').addEventListener('click', function() {
    const passwordInput = document.getElementById('password');
    const icon = this.querySelector('svg');
    
    if (passwordInput.type === 'password') {
      passwordInput.type = 'text';
      icon.setAttribute('stroke', 'var(--primary)');
    } else {
      passwordInput.type = 'password';
      icon.setAttribute('stroke', 'currentColor');
    }
  });

  document.getElementById('username').addEventListener('focus', function() {
  console.log('Username field focused');
});

document.getElementById('password').addEventListener('focus', function() {
  console.log('Password field focused');
});
</script>{% endblock %}
