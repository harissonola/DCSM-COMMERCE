nelmio_security:
    # Protection contre le clickjacking
    clickjacking:
        paths:
            '^/.*': DENY

    # Désactive le content type sniffing
    content_type:
        nosniff: true

    # Politique de referrer
    referrer_policy:
        enabled: true
        policies: ['no-referrer', 'strict-origin-when-cross-origin']
            
    # Configuration CSP
    csp:
        # Ces options sont au bon niveau sous csp
        hosts: []
        content_types: []
        enforce:
            level1_fallback: true
            browser_adaptive:
                enabled: false
            # Toutes les directives doivent être placées ici sous enforce
            report-uri: ['/csp-report']
            default-src: ["'self'"]
            script-src: ["'self'", "'unsafe-inline'", "'unsafe-eval'", "cdnjs.cloudflare.com"]
            style-src: ["'self'", "'unsafe-inline'", "cdnjs.cloudflare.com"]
            img-src: ["'self'", "data:"]
            font-src: ["'self'"]
            frame-src: ["'self'"]
            connect-src: ["'self'"]
            block-all-mixed-content: true