{% extends 'base.html.twig' %}

{% block title %}
  {{ shop.name }}
{% endblock %}

{% block body %}
  <style>
    /* Skeleton Loader en mode dark */
    .skeleton {
      background: linear-gradient(90deg, #333 25%, #444 50%, #333 75%);
      background-size: 200% 100%;
      animation: loading 1.5s infinite linear;
      border-radius: 10px;
      position: relative;
    }

    @keyframes loading {
      0% {
        background-position: 200% 0;
      }
      100% {
        background-position: -200% 0;
      }
    }

    .skeleton-box {
      width: 100%;
      height: 200px;
      background-color: #2a2a2a;
      margin-bottom: 20px;
    }

    .skeleton-text {
      height: 10px;
      width: 80%;
      margin-bottom: 5px;
      background-color: #2a2a2a;
      border-radius: 5px;
    }

    .skeleton-title {
      height: 20px;
      width: 60%;
      margin-bottom: 15px;
    }

    .skeleton-subtitle {
      height: 15px;
      width: 40%;
      margin-bottom: 10px;
    }

    .skeleton-description {
      height: 15px;
      width: 80%;
      margin-bottom: 20px;
    }

    .btn-skeleton {
      width: 120px;
      height: 35px;
      background-color: #2a2a2a;
      border-radius: 5px;
      margin-top: 10px;
    }
  </style>

  <section style="overflow: hidden;" class="hero align-items-center justify-content-center text-center">
    <div class="container" data-aos-duration="2000" data-aos="slide-left" data-aos-delay="100">
      <h1 class="text-primary" data-aos-duration="2000" data-aos="slide-down" data-aos-delay="700">{{ shop.name }}</h1>
      <p class="text-muted" data-aos-duration="2000" data-aos="slide-up" data-aos-delay="900">{{ shop.description }}</p>
    </div>
  </section>

  <section class="prods" id="prods">
    <div class="row" id="prod-container">
      {% if prods %}
        {% for prod in prods %}
          <div class="col-md-4">
            <div class="card prod-card skeleton" id="prod-card-{{ loop.index }}">
              <div class="skeleton-box"></div> <!-- Skeleton pour l'image -->

              <div class="card-body">
                <div class="skeleton-title skeleton-text"></div> <!-- Skeleton pour le titre -->
                <div class="skeleton-subtitle skeleton-text"></div> <!-- Skeleton pour le prix -->
                <div class="skeleton-description skeleton-text"></div> <!-- Skeleton pour la description -->
                <div class="btn-skeleton"></div> <!-- Skeleton pour le bouton -->
              </div>
            </div>
          </div>
        {% endfor %}
      {% else %}
        <h5 class="text-center text-danger">Aucun produit disponible pour le moment.</h5>
      {% endif %}
    </div>
  </section>

  <script>
    document.addEventListener('turbo:load', function() {
      // Sélectionner toutes les cartes de produits avec la classe 'prod-card'
      const prodCards = document.querySelectorAll('.prod-card');

      // Attendre 1 seconde avant de retirer la classe 'skeleton' et afficher le vrai contenu
      setTimeout(() => {
        prodCards.forEach(card => {
          // Retirer la classe 'skeleton' pour afficher les vrais contenus
          card.classList.remove('skeleton');

          // Retirer les éléments skeleton pour titre, sous-titre, description et bouton
          const titleSkeleton = card.querySelector('.skeleton-title');
          const subtitleSkeleton = card.querySelector('.skeleton-subtitle');
          const descriptionSkeleton = card.querySelector('.skeleton-description');
          const btnSkeleton = card.querySelector('.btn-skeleton');

          if (titleSkeleton) titleSkeleton.classList.add('d-none');
          if (subtitleSkeleton) subtitleSkeleton.classList.add('d-none');
          if (descriptionSkeleton) descriptionSkeleton.classList.add('d-none');
          if (btnSkeleton) btnSkeleton.classList.add('d-none');
          
          // Ajout du contenu réel
          const title = card.querySelector('.card-title');
          const subtitle = card.querySelector('.card-subtitle');
          const description = card.querySelector('.card-text');
          const button = card.querySelector('.btn');

          if (title) title.classList.remove('d-none');
          if (subtitle) subtitle.classList.remove('d-none');
          if (description) description.classList.remove('d-none');
          if (button) button.classList.remove('d-none');
        });
      }, 1000); // Délai de 1 seconde
    });
  </script>
{% endblock %}
