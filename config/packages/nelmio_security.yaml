nelmio_security:
    # Protection contre le clickjacking
    clickjacking:
        paths:
            '^/.*': DENY

    # Désactive le content type sniffing
    content_type:
        nosniff: true

    # Politique de referrer
    referrer_policy:
        enabled: true
        policies: ['no-referrer', 'strict-origin-when-cross-origin']
            
    # Configuration CSP
    csp:
        enabled: true
        report_logger_service: 'logger'
        hash:
            algorithm: sha256
        enforce:
            level1_fallback: true
        # Directives CSP
        report: # Utilisez 'report' au lieu de 'report_uri'
            uri: '/csp-report'
        
        # Les directives doivent être sous cette clé
        report_endpoints:
            default: '/csp-report'
        
        # Directives CSP
        directives:
            default-src: ["'self'"]
            script-src: ["'self'", "'unsafe-inline'", "'unsafe-eval'", "cdnjs.cloudflare.com"]
            style-src: ["'self'", "'unsafe-inline'", "cdnjs.cloudflare.com"]
            img-src: ["'self'", "data:"]
            font-src: ["'self'"]
            frame-src: ["'self'"]
            connect-src: ["'self'"]
            report-uri: ['/csp-report'] # Ajout de report-uri comme directive