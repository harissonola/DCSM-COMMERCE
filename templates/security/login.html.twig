{% extends 'base.html.twig' %}

{% block title %}Connexion
{% endblock %}

{% block body %}
	<div class="auth-wrapper dark">
		<div class="stars"></div>
		<div class="twinkling"></div>

		<div
			class="auth-container">
			<!-- Carte de connexion -->
			<div
				class="auth-card">
				<!-- Logo -->
				<div class="auth-logo">
					<img src="https://raw.githubusercontent.com/harissonola/my-cdn/main/img/bactrary-logo.png" alt="Bactrary" class="logo-img">
				</div>

				<h1 class="auth-title">Bienvenue</h1>
				<p class="auth-subtitle">Connectez-vous pour accéder à votre espace</p>

				{% if error %}
					<div class="alert alert-error">
						<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
							<circle cx="12" cy="12" r="10"></circle>
							<line x1="12" y1="8" x2="12" y2="12"></line>
							<line x1="12" y1="16" x2="12.01" y2="16"></line>
						</svg>
						<span>{{ error.messageKey|trans(error.messageData, 'security') }}</span>
					</div>
				{% endif %}

				<!-- Formulaire -->
				<form method="post" class="auth-form">
					<div class="form-group">
						<div class="input-wrapper">
							<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
								<path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
								<circle cx="12" cy="7" r="4"></circle>
							</svg>
							<input type="text" id="username" name="username" value="{{ last_username }}" required autofocus placeholder="Email ou nom d'utilisateur">
						</div>
					</div>

					<div class="form-group">
						<div class="input-wrapper">
							<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
								<rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
								<path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
							</svg>
							<input type="password" id="password" name="password" required placeholder="Mot de passe">
							<button type="button" class="toggle-password">
								<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
									<path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
									<circle cx="12" cy="12" r="3"></circle>
								</svg>
							</button>
						</div>
					</div>

					<div class="form-options">
						<div class="remember-me">
							<input type="checkbox" id="remember" name="_remember_me">
							<label for="remember">Se souvenir de moi</label>
						</div>
						<a href="{{ path('app_forgot_password_request') }}" class="forgot-password">
							Mot de passe oublié ?
						</a>
					</div>

					<input type="hidden" name="_csrf_token" value="{{ csrf_token('authenticate') }}">

					<button type="submit" class="btn-auth">
						<span>Se connecter</span>
						<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
							<line x1="5" y1="12" x2="19" y2="12"></line>
							<polyline points="12 5 19 12 12 19"></polyline>
						</svg>
					</button>
				</form>

				<!-- Séparateur -->
				<div class="auth-separator">
					<span>ou continuer avec</span>
				</div>

				<!-- Bouton Google -->
				<a href="{{ path('connect_google_start') }}" class="btn-social google">
					<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
						<path d="M18.364 5.636l-3.536 3.536m0 5.656l3.536 3.536M9.172 9.172L5.636 5.636m3.536 9.192l-3.536 3.536M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-5 0a4 4 0 11-8 0 4 4 0 018 0z"></path>
					</svg>
					<span>Google</span>
				</a>

				<!-- Lien d'inscription -->
				<div class="auth-footer">
					Pas encore de compte ?
					<a href="{{ path('app_register') }}">S'inscrire</a>
				</div>
			</div>
		</div>
	</div>

	<style>:root
	{
		--primary: #6c5ce7;
		--primary-hover: #5649c0;
		--text: #f8f9fa;
		--text-secondary: #adb5bd;
		--bg: #121212;
		--card-bg: #1e1e1e;
		--card-border: #333;
		--input-bg: #2d2d2d;
		--input-border: #444;
		--error: #ff6b6b;
		--success: #51cf66;
	}

	body {
		margin: 0;
		font-family: 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif;
	}

	.auth-wrapper {
		min-height: 100vh;
		display: flex;
		align-items: center;
		justify-content: center;
		background-color: var(--bg);
		color: var(--text);
		position: relative;
		overflow: hidden;
	}

	.stars,
	.twinkling {
		position: absolute;
		top: 0;
		left: 0;
		right: 0;
		bottom: 0;
		width: 100%;
		height: 100%;
	}

	.stars {
		background: #000 url('data:image/svg+xml;utf8, <svg xmlns="http://www.w3.org / 2000/svg" width="100" height="100" viewBox="0 0 100 100"><circle cx="10" cy="10" r="0.5" fill="white"/><circle cx="20" cy="30" r="0.5" fill="white"/><circle cx="30" cy="50" r="0.5" fill="white"/><circle cx="40" cy="70" r="0.5" fill="white"/><circle cx="50" cy="90" r="0.5" fill="white"/><circle cx="60" cy="20" r="0.5" fill="white"/><circle cx="70" cy="40" r="0.5" fill="white"/><circle cx="80" cy="60" r="0.5" fill="white"/><circle cx="90" cy="80" r="0.5" fill="white"/></svg>');
		z-index: 0;
	}

	.twinkling {
		background: transparent url('data:image/svg+xml;utf8, <svg xmlns="http://www.w3.org / 2000/svg" width="100" height="100" viewBox="0 0 100 100"><circle cx="15" cy="15" r="0.8" fill="white"/><circle cx="25" cy="35" r="0.8" fill="white"/><circle cx="35" cy="55" r="0.8" fill="white"/><circle cx="45" cy="75" r="0.8" fill="white"/><circle cx="55" cy="95" r="0.8" fill="white"/><circle cx="65" cy="25" r="0.8" fill="white"/><circle cx="75" cy="45" r="0.8" fill="white"/><circle cx="85" cy="65" r="0.8" fill="white"/><circle cx="95" cy="85" r="0.8" fill="white"/></svg>');
		animation: twinkle 3s infinite ease-in-out alternate;
		z-index: 1;
	}

	@keyframes twinkle {
		0% {
			opacity: 0.2;
		}
		100% {
			opacity: 0.8;
		}
	}

	.auth-container {
		width: 100%;
		max-width: 420px;
		padding: 1rem;
		position: relative;
		z-index: 2;
	}

	.auth-card {
		background: var(--card-bg);
		border-radius: 16px;
		padding: 2.5rem;
		box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
		text-align: center;
		border: 1px solid var(--card-border);
		backdrop-filter: blur(10px);
		transform: translateY(0);
		transition: all 0.3s ease;
	}

	.auth-card:hover {
		transform: translateY(-5px);
		box-shadow: 0 15px 35px rgba(0, 0, 0, 0.4);
	}

	.auth-logo {
		margin-bottom: 1.5rem;
	}

	.logo-img {
		height: 60px;
		filter: drop-shadow(0 0 10px rgba(108, 92, 231, 0.5));
	}

	.auth-title {
		font-size: 1.75rem;
		color: var(--text);
		margin-bottom: 0.5rem;
		font-weight: 600;
	}

	.auth-subtitle {
		color: var(--text-secondary);
		margin-bottom: 2rem;
		font-size: 1rem;
	}

	.alert-error {
		display: flex;
		align-items: center;
		background: rgba(255, 107, 107, 0.15);
		color: var(--error);
		padding: 0.75rem 1rem;
		border-radius: 8px;
		margin-bottom: 1.5rem;
		font-size: 0.9rem;
		border-left: 3px solid var(--error);
	}

	.alert-error svg {
		margin-right: 0.5rem;
	}

	.form-group {
		margin-bottom: 1.5rem;
		text-align: left;
	}

	.input-wrapper {
		position: relative;
		display: flex;
		align-items: center;
	}

	.input-wrapper svg {
		position: absolute;
		left: 15px;
		color: var(--text-secondary);
	}

	.input-wrapper input {
		width: 100%;
		padding: 0.875rem 1rem 0.875rem 3rem;
		background: var(--input-bg);
		border: 1px solid var(--input-border);
		border-radius: 10px;
		font-size: 1rem;
		color: var(--text);
		transition: all 0.3s ease;
	}

	.input-wrapper input:focus {
		border-color: var(--primary);
		box-shadow: 0 0 0 3px rgba(108, 92, 231, 0.2);
		outline: none;
	}

	.input-wrapper input::placeholder {
		color: var(--text-secondary);
	}

	.toggle-password {
		position: absolute;
		right: 15px;
		background: none;
		border: none;
		cursor: pointer;
		color: var(--text-secondary);
		display: flex;
		align-items: center;
		justify-content: center;
	}

	.form-options {
		display: flex;
		justify-content: space-between;
		align-items: center;
		margin: 1.5rem 0;
		font-size: 0.9rem;
	}

	.remember-me {
		display: flex;
		align-items: center;
	}

	.remember-me input {
		margin-right: 0.5rem;
		accent-color: var(--primary);
	}

	.remember-me label {
		color: var(--text-secondary);
	}

	.forgot-password {
		color: var(--primary);
		text-decoration: none;
		transition: all 0.2s;
	}

	.forgot-password:hover {
		color: var(--primary-hover);
		text-decoration: underline;
	}

	.btn-auth {
		width: 100%;
		padding: 1rem;
		background: linear-gradient(135deg, var(--primary), var(--primary-hover));
		color: white;
		border: none;
		border-radius: 10px;
		font-size: 1rem;
		font-weight: 500;
		cursor: pointer;
		transition: all 0.3s ease;
		margin-bottom: 1.5rem;
		display: flex;
		align-items: center;
		justify-content: center;
		gap: 0.5rem;
	}

	.btn-auth:hover {
		transform: translateY(-2px);
		box-shadow: 0 5px 20px rgba(108, 92, 231, 0.4);
	}

	.btn-auth svg {
		transition: transform 0.3s ease;
	}

	.btn-auth:hover svg {
		transform: translateX(3px);
	}

	.auth-separator {
		position: relative;
		margin: 1.5rem 0;
		color: var(--text-secondary);
		font-size: 0.875rem;
	}

	.auth-separator::before,
	.auth-separator::after {
		content: "";
		position: absolute;
		top: 50%;
		width: 45%;
		height: 1px;
		background: linear-gradient(90deg, transparent, var(--input-border), transparent);
	}

	.auth-separator::before {
		left: 0;
	}

	.auth-separator::after {
		right: 0;
	}

	.btn-social {
		display: flex;
		align-items: center;
		justify-content: center;
		width: 100%;
		padding: 0.875rem;
		border-radius: 10px;
		font-size: 1rem;
		font-weight: 500;
		cursor: pointer;
		transition: all 0.3s ease;
		margin-bottom: 1.5rem;
		text-decoration: none;
		gap: 0.5rem;
	}

	.btn-social.google {
		background: var(--input-bg);
		color: var(--text);
		border: 1px solid var(--input-border);
	}

	.btn-social.google:hover {
		background: #2a2a2a;
		transform: translateY(-2px);
		box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
	}

	.auth-footer {
		font-size: 0.9rem;
		color: var(--text-secondary);
	}

	.auth-footer a {
		color: var(--primary);
		text-decoration: none;
		font-weight: 500;
		transition: all 0.2s;
	}

	.auth-footer a:hover {
		color: var(--primary-hover);
		text-decoration: underline;
	}

	@media(max-width: 576px) {
		.auth-card {
			padding: 1.5rem;
		}

		.auth-title {
			font-size: 1.5rem;
		}
	}
</style>

 <script>
  // Toggle password visibility
  document.querySelector('.toggle-password').addEventListener('click', function() {
    const passwordInput = document.getElementById('password');
    const icon = this.querySelector('svg');
    
    if (passwordInput.type === 'password') {
      passwordInput.type = 'text';
      icon.setAttribute('data-icon', 'eye-off');
    } else {
      passwordInput.type = 'password';
      icon.setAttribute('data-icon', 'eye');
    }
  });
</script>{% endblock %}