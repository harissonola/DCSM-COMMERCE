{% extends 'base.html.twig' %}

{% block title %}DCSM-COMMERCE - Investissement crypto avec gains récurrents{% endblock %}

{% block body %}
  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top">
    <div class="container">
      <a class="navbar-brand" href="{{ path('app_home') }}">
        <i class="fas fa-coins me-2"></i>DCSM-COMMERCE
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item">
            <a class="nav-link active" href="{{ path('app_home') }}">Accueil</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="{{ path('app_products') }}">Produits</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="{{ path('app_earnings') }}">Mes gains</a>
          </li>
          {% if app.user %}
            <li class="nav-item">
              <a class="nav-link" href="{{ path('app_referral') }}">Parrainage</a>
            </li>
          {% endif %}
        </ul>
        <div class="ms-lg-3 mt-3 mt-lg-0">
          {% if app.user %}
            <a href="{{ path('app_account') }}" class="btn btn-outline-light me-2">Mon compte</a>
            <a href="{{ path('app_logout') }}" class="btn btn-primary">Déconnexion</a>
          {% else %}
            <a href="{{ path('app_login') }}" class="btn btn-outline-light me-2">Connexion</a>
            <a href="{{ path('app_register') }}" class="btn btn-primary">S'inscrire</a>
          {% endif %}
        </div>
      </div>
    </div>
  </nav>

  <!-- Hero Section -->
  <section class="hero-section bg-primary text-white py-5">
    <div class="container py-4">
      <div class="row align-items-center">
        <div class="col-lg-6">
          <h1 class="display-4 fw-bold mb-4">Gagnez <span class="text-warning">4%</span> sur vos produits</h1>
          <p class="lead mb-4">Chaque produit acheté vous rapporte automatiquement 4% de sa valeur actuelle quotidiennement.</p>
          <div class="d-flex flex-wrap gap-3">
            {% if app.user %}
              <a href="{{ path('app_products') }}" class="btn btn-light btn-lg px-4">Voir les produits</a>
            {% else %}
              <a href="{{ path('app_register') }}" class="btn btn-light btn-lg px-4">Commencer à 4%</a>
            {% endif %}
            <a href="#how-it-works" class="btn btn-outline-light btn-lg px-4">
              <i class="fas fa-play me-2"></i>Comment ça marche
            </a>
          </div>
        </div>
        <div class="col-lg-6 d-none d-lg-block">
          <img src="{{ asset('build/images/crypto-dashboard.png') }}" alt="Dashboard crypto" class="img-fluid">
        </div>
      </div>
    </div>
  </section>

  <!-- User Stats Section -->
  {% if app.user %}
    <section class="py-4 bg-light">
      <div class="container">
        <div class="row g-3">
          <div class="col-md-3">
            <div class="stats-card bg-white p-3 rounded text-center">
              <i class="fas fa-boxes text-primary mb-2 fs-4"></i>
              <div class="stats-number fs-3 fw-bold">{{ app.user.products|length }}</div>
              <div class="stats-label text-muted">Produits achetés</div>
            </div>
          </div>
          <div class="col-md-3">
            <div class="stats-card bg-white p-3 rounded text-center">
              <i class="fas fa-coins text-primary mb-2 fs-4"></i>
              <div class="stats-number fs-3 fw-bold">{{ total_value|format_currency('EUR') }}</div>
              <div class="stats-label text-muted">Valeur totale</div>
            </div>
          </div>
          <div class="col-md-3">
            <div class="stats-card bg-white p-3 rounded text-center">
              <i class="fas fa-percentage text-primary mb-2 fs-4"></i>
              <div class="stats-number fs-3 fw-bold">{{ app.user.earningRate }}%</div>
              <div class="stats-label text-muted">Taux actuel</div>
            </div>
          </div>
          <div class="col-md-3">
            <div class="stats-card bg-white p-3 rounded text-center">
              <i class="fas fa-money-bill-wave text-primary mb-2 fs-4"></i>
              <div class="stats-number fs-3 fw-bold">{{ daily_earnings|format_currency('EUR') }}</div>
              <div class="stats-label text-muted">Gains quotidiens</div>
            </div>
          </div>
        </div>
      </div>
    </section>
  {% endif %}

  <!-- How It Works Section -->
  <section id="how-it-works" class="py-5">
    <div class="container py-4">
      <div class="text-center mb-5">
        <h2 class="fw-bold">Comment fonctionnent vos 4% ?</h2>
        <p class="lead text-muted">Un système simple et transparent</p>
      </div>
      <div class="row g-4">
        <div class="col-md-4">
          <div class="feature-card bg-white p-4 rounded shadow-sm h-100">
            <div class="feature-icon text-primary mb-3 fs-2">
              <i class="fas fa-shopping-cart"></i>
            </div>
            <h3 class="fw-bold">1. Achetez des produits</h3>
            <p>Choisissez parmi notre sélection de produits d'investissement crypto.</p>
          </div>
        </div>
        <div class="col-md-4">
          <div class="feature-card bg-white p-4 rounded shadow-sm h-100">
            <div class="feature-icon text-primary mb-3 fs-2">
              <i class="fas fa-chart-line"></i>
            </div>
            <h3 class="fw-bold">2. Recevez vos 4%</h3>
            <p>Chaque jour, vous gagnez 4% de la valeur actuelle de chaque produit.</p>
          </div>
        </div>
        <div class="col-md-4">
          <div class="feature-card bg-white p-4 rounded shadow-sm h-100">
            <div class="feature-icon text-primary mb-3 fs-2">
              <i class="fas fa-users"></i>
            </div>
            <h3 class="fw-bold">3. Augmentez votre taux</h3>
            <p>Parrainez des amis pour augmenter votre taux jusqu'à 10%.</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Products Section -->
  <section class="py-5 bg-light">
    <div class="container py-4">
      <div class="text-center mb-5">
        <h2 class="fw-bold">Nos produits populaires</h2>
        <p class="lead text-muted">Tous génèrent 4% de rendement quotidien</p>
      </div>
      <div class="row g-4">
        {% for product in products|slice(0, 6) %}
          <div class="col-lg-4 col-md-6">
            <div class="card h-100 product-card shadow-sm">
              {% if product.isNew %}
                <span class="badge bg-success position-absolute top-0 start-0 m-2">Nouveau</span>
              {% endif %}
              
              <div class="product-img-container" style="height: 200px;">
                <img src="{{ asset('uploads/products/' ~ product.image) }}" 
                     class="card-img-top h-100 w-100 object-fit-cover" 
                     alt="{{ product.name }}"
                     loading="lazy">
              </div>
              
              <div class="card-body">
                <h3 class="card-title fw-bold">{{ product.name }}</h3>
                <div class="d-flex justify-content-between align-items-center mb-3">
                  <span class="h4 text-primary">{{ product.currentPrice|format_currency('EUR') }}</span>
                  <span class="badge bg-warning text-dark">4% quotidien</span>
                </div>
                <p class="card-text text-muted">{{ product.shortDescription }}</p>
              </div>
              
              <div class="card-footer bg-white border-top-0">
                <div class="d-grid gap-2">
                  <a href="{{ path('app_product_show', {id: product.id}) }}" 
                     class="btn btn-primary">
                    <i class="fas fa-info-circle me-2"></i>Détails
                  </a>
                  {% if app.user %}
                    <a href="{{ path('app_product_buy', {id: product.id}) }}" 
                       class="btn btn-success">
                      <i class="fas fa-shopping-cart me-2"></i>Acheter
                    </a>
                  {% endif %}
                </div>
              </div>
            </div>
          </div>
        {% else %}
          <div class="col-12">
            <div class="alert alert-info text-center">
              Aucun produit disponible pour le moment.
            </div>
          </div>
        {% endfor %}
      </div>
      
      <div class="text-center mt-5">
        <a href="{{ path('app_products') }}" class="btn btn-outline-primary btn-lg px-5">
          Voir tous les produits
        </a>
      </div>
    </div>
  </section>

  <!-- Earnings Calculator -->
  <section class="py-5">
    <div class="container py-4">
      <div class="row align-items-center">
        <div class="col-lg-6 mb-5 mb-lg-0">
          <h2 class="fw-bold mb-4">Simulez vos gains</h2>
          <div class="calculator bg-white p-4 rounded shadow-sm">
            <div class="mb-3">
              <label for="investmentAmount" class="form-label">Montant investi (€)</label>
              <input type="number" class="form-control" id="investmentAmount" value="1000" min="100">
            </div>
            <div class="mb-3">
              <label for="earningRate" class="form-label">Votre taux de gains</label>
              <select class="form-select" id="earningRate">
                <option value="4">4% (par défaut)</option>
                <option value="6">6% (5 filleuls)</option>
                <option value="7">7% (10 filleuls)</option>
                <option value="10">10% (20 filleuls)</option>
              </select>
            </div>
            <div class="results bg-light p-3 rounded mb-3">
              <div class="d-flex justify-content-between">
                <span>Gains quotidiens:</span>
                <span class="fw-bold" id="dailyEarnings">€40.00</span>
              </div>
              <div class="d-flex justify-content-between">
                <span>Gains mensuels:</span>
                <span class="fw-bold" id="monthlyEarnings">€1,200.00</span>
              </div>
              <div class="d-flex justify-content-between">
                <span>Gains annuels:</span>
                <span class="fw-bold" id="yearlyEarnings">€14,400.00</span>
              </div>
            </div>
            <button class="btn btn-primary w-100" id="calculateBtn">
              <i class="fas fa-calculator me-2"></i>Calculer
            </button>
          </div>
        </div>
        <div class="col-lg-6">
          <div class="p-4">
            <h3 class="fw-bold mb-3">Augmentez vos gains avec le parrainage</h3>
            <p class="mb-4">En parrainant des amis, vous augmentez votre taux de gains sur tous vos produits :</p>
            
            <ul class="list-group mb-4">
              <li class="list-group-item d-flex justify-content-between align-items-center">
                <span>5 filleuls actifs</span>
                <span class="badge bg-primary rounded-pill">6%</span>
              </li>
              <li class="list-group-item d-flex justify-content-between align-items-center">
                <span>10 filleuls actifs</span>
                <span class="badge bg-primary rounded-pill">7%</span>
              </li>
              <li class="list-group-item d-flex justify-content-between align-items-center">
                <span>20 filleuls actifs</span>
                <span class="badge bg-primary rounded-pill">10%</span>
              </li>
              <li class="list-group-item d-flex justify-content-between align-items-center">
                <span>40 filleuls actifs</span>
                <span class="badge bg-success rounded-pill">10% + €10 bonus</span>
              </li>
            </ul>
            
            {% if app.user %}
              <a href="{{ path('app_referral') }}" class="btn btn-primary w-100">
                <i class="fas fa-user-plus me-2"></i>Inviter des amis
              </a>
            {% else %}
              <a href="{{ path('app_register') }}" class="btn btn-primary w-100">
                <i class="fas fa-user-plus me-2"></i>S'inscrire pour parrainer
              </a>
            {% endif %}
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Testimonials -->
  <section class="py-5 bg-light">
    <div class="container py-4">
      <div class="text-center mb-5">
        <h2 class="fw-bold">Ils utilisent DCSM-COMMERCE</h2>
        <p class="lead text-muted">Ce que nos utilisateurs disent de nous</p>
      </div>
      <div class="row g-4">
        {% for testimonial in testimonials %}
          <div class="col-md-4">
            <div class="testimonial-card bg-white p-4 rounded shadow-sm h-100">
              <div class="d-flex align-items-center mb-3">
                <img src="{{ asset('uploads/avatars/' ~ testimonial.avatar) }}" class="rounded-circle me-3" width="50" alt="{{ testimonial.name }}">
                <div>
                  <h5 class="mb-0">{{ testimonial.name }}</h5>
                  <small class="text-muted">{{ testimonial.position }}</small>
                </div>
              </div>
              <p class="mb-0">"{{ testimonial.content }}"</p>
              <div class="mt-3 text-warning">
                {% for i in 1..5 %}
                  {% if i <= testimonial.rating %}
                    <i class="fas fa-star"></i>
                  {% else %}
                    <i class="far fa-star"></i>
                  {% endif %}
                {% endfor %}
              </div>
            </div>
          </div>
        {% endfor %}
      </div>
    </div>
  </section>

  <!-- CTA Section -->
  <section class="py-5 bg-primary text-white">
    <div class="container py-4 text-center">
      <h2 class="fw-bold mb-4">Prêt à générer des revenus passifs ?</h2>
      <p class="lead mb-5">Commencez avec 4% et augmentez jusqu'à 10% grâce au parrainage.</p>
      {% if app.user %}
        <a href="{{ path('app_products') }}" class="btn btn-light btn-lg px-5 me-3">
          <i class="fas fa-box-open me-2"></i>Voir les produits
        </a>
      {% else %}
        <a href="{{ path('app_register') }}" class="btn btn-light btn-lg px-5 me-3">
          <i class="fas fa-user-plus me-2"></i>S'inscrire gratuitement
        </a>
      {% endif %}
      <a href="{{ path('app_contact') }}" class="btn btn-outline-light btn-lg px-5">
        <i class="fas fa-question-circle me-2"></i>Questions ?
      </a>
    </div>
  </section>

  <!-- Footer -->
  <footer class="bg-dark text-white py-5">
    <div class="container">
      <div class="row">
        <div class="col-lg-4 mb-4 mb-lg-0">
          <h5 class="mb-4">
            <i class="fas fa-coins me-2"></i>DCSM-COMMERCE
          </h5>
          <p>La plateforme qui vous paye 4% sur vos investissements crypto, et jusqu'à 10% avec parrainage.</p>
          <div class="social-icons mt-4">
            <a href="#" class="text-white me-3"><i class="fab fa-facebook-f"></i></a>
            <a href="#" class="text-white me-3"><i class="fab fa-twitter"></i></a>
            <a href="#" class="text-white me-3"><i class="fab fa-telegram"></i></a>
            <a href="#" class="text-white"><i class="fab fa-instagram"></i></a>
          </div>
        </div>
        <div class="col-lg-2 col-md-4 mb-4 mb-md-0">
          <h5 class="mb-4">Navigation</h5>
          <a href="{{ path('app_home') }}" class="text-white-50 d-block mb-2">Accueil</a>
          <a href="{{ path('app_products') }}" class="text-white-50 d-block mb-2">Produits</a>
          <a href="{{ path('app_earnings') }}" class="text-white-50 d-block mb-2">Gains</a>
          <a href="{{ path('app_referral') }}" class="text-white-50 d-block mb-2">Parrainage</a>
        </div>
        <div class="col-lg-2 col-md-4 mb-4 mb-md-0">
          <h5 class="mb-4">Légal</h5>
          <a href="{{ path('app_terms') }}" class="text-white-50 d-block mb-2">CGU</a>
          <a href="{{ path('app_privacy') }}" class="text-white-50 d-block mb-2">Confidentialité</a>
          <a href="{{ path('app_cookies') }}" class="text-white-50 d-block mb-2">Cookies</a>
        </div>
        <div class="col-lg-4">
          <h5 class="mb-4">Newsletter</h5>
          <p>Abonnez-vous pour recevoir nos conseils et offres spéciales.</p>
          <form class="mt-3">
            <div class="input-group mb-3">
              <input type="email" class="form-control" placeholder="Votre email">
              <button class="btn btn-primary" type="submit">S'abonner</button>
            </div>
          </form>
        </div>
      </div>
      <hr class="my-4 bg-secondary">
      <div class="row">
        <div class="col-md-6 text-center text-md-start">
          <p class="small mb-0">© {{ "now"|date("Y") }} DCSM-COMMERCE. Tous droits réservés.</p>
        </div>
        <div class="col-md-6 text-center text-md-end">
          <p class="small mb-0">
            <span class="text-muted">Cryptos supportées:</span>
            <span class="text-warning">BTC</span>,
            <span class="text-info">ETH</span>,
            <span class="text-success">USDT</span>,
            <span class="text-primary">+15 autres</span>
          </p>
        </div>
      </div>
    </div>
  </footer>
{% endblock %}

{% block stylesheets %}
{{ parent() }}
<style>
  .product-card {
    transition: all 0.3s ease;
    border-radius: 10px;
    overflow: hidden;
  }
  .product-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 20px rgba(0,0,0,0.15);
  }
  .product-img-container {
    background: #f8f9fa;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  .object-fit-cover {
    object-fit: cover;
    object-position: center;
  }
</style>
{% endblock %}

{% block customScript %}
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Animation des cartes produit
    const productCards = document.querySelectorAll('.product-card');
    productCards.forEach(card => {
      card.addEventListener('mouseenter', function() {
        this.style.transform = 'translateY(-5px)';
        this.style.boxShadow = '0 10px 20px rgba(0,0,0,0.15)';
      });
      card.addEventListener('mouseleave', function() {
        this.style.transform = '';
        this.style.boxShadow = '';
      });
    });

    // Calculateur de gains
    const calculateEarnings = () => {
      const amount = parseFloat(document.getElementById('investmentAmount').value);
      const rate = parseFloat(document.getElementById('earningRate').value);
      
      const daily = (amount * rate / 100).toFixed(2);
      const monthly = (daily * 30).toFixed(2);
      const yearly = (daily * 365).toFixed(2);
      
      document.getElementById('dailyEarnings').textContent = '€' + daily;
      document.getElementById('monthlyEarnings').textContent = '€' + monthly;
      document.getElementById('yearlyEarnings').textContent = '€' + yearly;
    };
    
    if(document.getElementById('calculateBtn')) {
      document.getElementById('calculateBtn').addEventListener('click', calculateEarnings);
      document.getElementById('investmentAmount').addEventListener('input', calculateEarnings);
      document.getElementById('earningRate').addEventListener('change', calculateEarnings);
      calculateEarnings();
    }

    // Smooth scrolling
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function(e) {
        e.preventDefault();
        document.querySelector(this.getAttribute('href')).scrollIntoView({
          behavior: 'smooth'
        });
      });
    });
  });
</script>
{% endblock %}