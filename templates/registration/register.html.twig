{% extends 'base.html.twig' %}

{% block title %}S'Inscrire
{% endblock %}

{% block body %}
	<style>:root
	{
		--primary: #6c5ce7;
		--primary-light: #a29bfe;
		--primary-dark: #5649c0;
		--secondary: #00cec9;
		--dark: #0f1521;
		--darker: #0a0e17;
		--light: #f8f9fa;
		--text: #ffffff;
		--text-secondary: #b2b2b2;
	}

	body {
		background: linear-gradient(135deg, var(--darker) 0%, var(--dark) 100%);
		min-height: 100vh;
		font-family: 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif;
		overflow-x: hidden;
	}

	/* Effet de particules animées */
	.particles {
		position: fixed;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		z-index: 0;
		background-image: radial-gradient(circle at 20% 30%, rgba(108, 92, 231, 0.1) 0%, transparent 25%), radial-gradient(circle at 80% 70%, rgba(0, 206, 201, 0.1) 0%, transparent 25%);
		animation: float 20s infinite ease-in-out alternate;
	}

	@keyframes float {
		0,
		100% {
			transform: translate(0, 0) rotate(0deg);
		}
		25% {
			transform: translate(-10px, -10px) rotate(-1deg);
		}
		50% {
			transform: translate(0, -20px) rotate(0deg);
		}
		75% {
			transform: translate(10px, -10px) rotate(1deg);
		}
	}

	/* Conteneur principal */
	.auth-container {
		position: relative;
		z-index: 1;
		max-width: 800px;
		margin: 0 auto;
		padding: 2rem;
	}

	/* Carte d'inscription */
	.register-card {
		background: rgba(26, 31, 53, 0.9);
		backdrop-filter: blur(10px);
		-webkit-backdrop-filter: blur(10px);
		border-radius: 20px;
		padding: 2.5rem;
		box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
		border: 1px solid rgba(0, 195, 255, 0.1);
		transition: all 0.4s ease;
	}

	.register-card:hover {
		transform: translateY(-5px);
		box-shadow: 0 20px 40px rgba(0, 195, 255, 0.2);
	}

	/* Titre */
	.register-title {
		font-size: 2.2rem;
		color: white;
		text-align: center;
		margin-bottom: 1.5rem;
		background: linear-gradient(90deg, var(--primary), var(--secondary));
		-webkit-background-clip: text;
		background-clip: text;
		color: transparent;
		position: relative;
	}

	.register-title::after {
		content: '';
		position: absolute;
		bottom: -10px;
		left: 50%;
		transform: translateX(-50%);
		width: 80px;
		height: 3px;
		background: linear-gradient(90deg, var(--primary), var(--secondary));
		border-radius: 3px;
	}

	/* Formulaires */
	.form-group {
		margin-bottom: 1.5rem;
	}

	.form-control {
		background: rgba(45, 45, 65, 0.6);
		border: 1px solid rgba(255, 255, 255, 0.1);
		border-radius: 10px;
		color: var(--text);
		padding: 0.875rem 1rem;
		transition: all 0.3s ease;
	}

	.form-control:focus {
		background: rgba(45, 45, 65, 0.8);
		border-color: var(--primary);
		box-shadow: 0 0 0 3px rgba(108, 92, 231, 0.3);
		color: white;
	}

	.form-control::placeholder {
		color: var(--text-secondary);
	}

	/* Boutons */
	.btn-wizard {
		width: 100%;
		padding: 1rem;
		background: linear-gradient(45deg, var(--primary), var(--primary-dark));
		border: none;
		border-radius: 10px;
		color: white;
		font-weight: 600;
		margin-top: 1rem;
		box-shadow: 0 5px 15px rgba(108, 92, 231, 0.3);
		transition: all 0.3s ease;
		position: relative;
		overflow: hidden;
	}

	.btn-wizard:hover {
		transform: translateY(-3px);
		box-shadow: 0 8px 20px rgba(108, 92, 231, 0.4);
	}

	.btn-wizard::before {
		content: '';
		position: absolute;
		top: 0;
		left: -100%;
		width: 100%;
		height: 100%;
		background: linear-gradient(45deg, var(--primary-dark), var(--primary));
		transition: all 0.4s ease;
		z-index: -1;
	}

	.btn-wizard:hover::before {
		left: 0;
	}

	/* Bouton Google */
	.btn-google {
		width: 100%;
		padding: 0.875rem;
		background: rgba(255, 255, 255, 0.1);
		border: 1px solid rgba(255, 255, 255, 0.2);
		border-radius: 10px;
		color: white;
		font-weight: 500;
		display: flex;
		align-items: center;
		justify-content: center;
		gap: 0.75rem;
		margin: 1.5rem 0;
		transition: all 0.3s ease;
	}

	.btn-google:hover {
		background: rgba(255, 255, 255, 0.15);
		transform: translateY(-2px);
		box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
	}

	.btn-google img {
		width: 20px;
		height: 20px;
	}

	/* Liens */
	.auth-link {
		color: var(--text-secondary);
		text-align: center;
		display: block;
		margin-top: 1.5rem;
		transition: all 0.3s ease;
	}

	.auth-link:hover {
		color: var(--primary-light);
		text-decoration: none;
	}

	/* Wizard mobile */
	.wizard-step {
		animation: fadeIn 0.5s ease;
	}

	@keyframes fadeIn {
		from {
			opacity: 0;
			transform: translateY(10px);
		}
		to {
			opacity: 1;
			transform: translateY(0);
		}
	}

	/* Checkbox personnalisé */
	.custom-checkbox .custom-control-input:checked~.custom-control-label::before {
		background-color: var(--primary);
		border-color: var(--primary);
	}

	/* Version desktop */
	.desktop-form .form-row {
		margin-bottom: 1.5rem;
	}

	/* Responsive */
	@media(max-width: 768px) {
		.auth-container {
			padding: 1rem;
		}

		.register-card {
			padding: 1.5rem;
		}

		.register-title {
			font-size: 1.8rem;
		}
	}
</style>

<div class="particles"></div>

<div class="container auth-container">
	<div class="row justify-content-center">
		{% if app.request.headers.get('User-Agent') matches '/(android|iphone|ipad|mobile)/i' %}
			<!-- Mobile Wizard -->
			<div class="col-md-8 col-lg-6">
				<div class="register-card">
					<h1 class="register-title">Inscription</h1>

					{{ form_start(registrationForm, {'attr': {'data-turbo': 'false', 'class': 'wizard-form'}) }}

					<div id="wizard-step-1" class="wizard-step">
						<div class="form-group">
							{{ form_row(registrationForm.lname, {'attr': {'class': 'form-control'}}) }}
						</div>
						<div class="form-group">
							{{ form_row(registrationForm.fname, {'attr': {'class': 'form-control'}}) }}
						</div>
						<button type="button" class="btn-wizard" onclick="nextStep(2)">
							Suivant
							<i class="fas fa-arrow-right ml-2"></i>
						</button>
					</div>

					<div id="wizard-step-2" class="wizard-step d-none">
						<div class="form-group">
							{{ form_row(registrationForm.username, {'attr': {'class': 'form-control'}}) }}
						</div>
						<div class="form-group">
							{{ form_row(registrationForm.email, {'attr': {'class': 'form-control'}}) }}
						</div>
						<div class="d-flex justify-content-between">
							<button type="button" class="btn-wizard" style="width: 48%;" onclick="prevStep(1)">
								<i class="fas fa-arrow-left mr-2"></i>
								Précédent
							</button>
							<button type="button" class="btn-wizard" style="width: 48%;" onclick="nextStep(3)">
								Suivant
								<i class="fas fa-arrow-right ml-2"></i>
							</button>
						</div>
					</div>

					<div id="wizard-step-3" class="wizard-step d-none">
						<div class="form-group">
							{{ form_row(registrationForm.photo, {'attr': {'class': 'form-control-file'}}) }}
						</div>
						<div class="form-group">
							{{ form_row(registrationForm.country, {'attr': {'class': 'form-control'}}) }}
						</div>
						<div class="d-flex justify-content-between">
							<button type="button" class="btn-wizard" style="width: 48%;" onclick="prevStep(2)">
								<i class="fas fa-arrow-left mr-2"></i>
								Précédent
							</button>
							<button type="button" class="btn-wizard" style="width: 48%;" onclick="nextStep(4)">
								Suivant
								<i class="fas fa-arrow-right ml-2"></i>
							</button>
						</div>
					</div>

					<div id="wizard-step-4" class="wizard-step d-none">
						<div class="form-group">
							{{ form_row(registrationForm.plainPassword, {'attr': {'class': 'form-control'}}) }}
						</div>
						<div class="form-group">
							{{ form_row(registrationForm.confirmPassword, {'attr': {'class': 'form-control'}}) }}
						</div>
						<div class="d-flex justify-content-between">
							<button type="button" class="btn-wizard" style="width: 48%;" onclick="prevStep(3)">
								<i class="fas fa-arrow-left mr-2"></i>
								Précédent
							</button>
							<button type="button" class="btn-wizard" style="width: 48%;" onclick="nextStep(5)">
								Suivant
								<i class="fas fa-arrow-right ml-2"></i>
							</button>
						</div>
					</div>

					<div id="wizard-step-5" class="wizard-step d-none">
						<div class="form-group">
							{{ form_row(registrationForm.referredBy, {'attr': {'class': 'form-control'}}) }}
						</div>
						<div class="form-group form-check">
							{{ form_widget(registrationForm.agreeTerms, {'attr': {'class': 'form-check-input'}}) }}
							{{ form_label(registrationForm.agreeTerms, null, {'label_attr': {'class': 'form-check-label'}}) }}
						</div>
						<div class="d-flex justify-content-between">
							<button type="button" class="btn-wizard" style="width: 48%;" onclick="prevStep(4)">
								<i class="fas fa-arrow-left mr-2"></i>
								Précédent
							</button>
							<button type="submit" class="btn-wizard" style="width: 48%;">
								S'inscrire
								<i class="fas fa-user-plus ml-2"></i>
							</button>
						</div>
					</div>

					{{ form_end(registrationForm) }}

					<a href="{{ path('connect_google_start') }}" class="btn-google">
						<img src="https://upload.wikimedia.org/wikipedia/commons/5/53/Google_%22G%22_Logo.svg" alt="Google">
						S'inscrire avec Google
					</a>

					<a href="{{ path('app_login') }}" class="auth-link">
						Vous avez déjà un compte ? Connectez-vous
					</a>
				</div>
			</div>
		{% else %}
			<!-- Desktop Version -->
			<div class="col-md-10 col-lg-8">
				<div class="register-card">
					<h1 class="register-title">Créer un compte</h1>

					{{ form_start(registrationForm, {'attr': {'data-turbo': 'false', 'class': 'desktop-form'}) }}

					<div class="form-row">
						<div class="col-md-6 form-group">
							{{ form_row(registrationForm.lname, {'attr': {'class': 'form-control'}}) }}
						</div>
						<div class="col-md-6 form-group">
							{{ form_row(registrationForm.fname, {'attr': {'class': 'form-control'}}) }}
						</div>
					</div>

					<div class="form-row">
						<div class="col-md-6 form-group">
							{{ form_row(registrationForm.username, {'attr': {'class': 'form-control'}}) }}
						</div>
						<div class="col-md-6 form-group">
							{{ form_row(registrationForm.email, {'attr': {'class': 'form-control'}}) }}
						</div>
					</div>

					<div class="form-row">
						<div class="col-md-6 form-group">
							{{ form_row(registrationForm.photo, {'attr': {'class': 'form-control-file'}}) }}
						</div>
						<div class="col-md-6 form-group">
							{{ form_row(registrationForm.country, {'attr': {'class': 'form-control'}}) }}
						</div>
					</div>

					<div class="form-row">
						<div class="col-md-6 form-group">
							{{ form_row(registrationForm.plainPassword, {'attr': {'class': 'form-control'}}) }}
						</div>
						<div class="col-md-6 form-group">
							{{ form_row(registrationForm.confirmPassword, {'attr': {'class': 'form-control'}}) }}
						</div>
					</div>

					<div class="form-group">
						{{ form_row(registrationForm.referredBy, {'attr': {'class': 'form-control'}}) }}
					</div>

					<div class="form-group form-check">
						{{ form_widget(registrationForm.agreeTerms, {'attr': {'class': 'form-check-input'}}) }}
						{{ form_label(registrationForm.agreeTerms, null, {'label_attr': {'class': 'form-check-label'}}) }}
					</div>

					<button type="submit" class="btn-wizard">
						S'inscrire
						<i class="fas fa-user-plus ml-2"></i>
					</button>

					<a href="{{ path('connect_google_start') }}" class="btn-google">
						<img src="https://upload.wikimedia.org/wikipedia/commons/5/53/Google_%22G%22_Logo.svg" alt="Google">
						S'inscrire avec Google
					</a>

					<a href="{{ path('app_login') }}" class="auth-link">
						Vous avez déjà un compte ? Connectez-vous
					</a>

					{{ form_end(registrationForm) }}
				</div>
			</div>
		{% endif %}
	</div>
</div>

 <script>
function nextStep(step) {
  document.querySelectorAll('.wizard-step').forEach(el => {
    el.classList.remove('animate__animated', 'animate__fadeIn');
    el.classList.add('d-none');
  });
  const nextStep = document.getElementById(`wizard-step-${step}`);
  nextStep.classList.remove('d-none');
  nextStep.classList.add('animate__animated', 'animate__fadeIn');
}

function prevStep(step) {
  document.querySelectorAll('.wizard-step').forEach(el => {
    el.classList.remove('animate__animated', 'animate__fadeIn');
    el.classList.add('d-none');
  });
  const prevStep = document.getElementById(`wizard-step-${step}`);
  prevStep.classList.remove('d-none');
  prevStep.classList.add('animate__animated', 'animate__fadeIn');
}

// Animation pour les champs de formulaire
document.querySelectorAll('.form-control').forEach(input => {
  input.addEventListener('focus', function() {
    this.parentElement.classList.add('focused');
  });
  
  input.addEventListener('blur', function() {
    if (!this.value) {
      this.parentElement.classList.remove('focused');
    }
  });
});
</script>
{% endblock %}
