nelmio_security:
    # Protection contre le clickjacking
    clickjacking:
        paths:
            "^/.*": DENY

    # Désactive le content type sniffing
    content_type:
        nosniff: true

    # Politique de referrer
    referrer_policy:
        enabled: true
        policies: ["no-referrer", "strict-origin-when-cross-origin"]

    # Configuration CSP
    # Configuration CSP
    csp:
        enabled: true
        report_logger_service: "logger"
        hash:
            algorithm: sha256
        enforce:
            level1_fallback: true
        report: true # Activer le reporting sans sous-clé uri
        report_endpoint: "/csp-report" # Utiliser report_endpoint au lieu de report_uri

        # Directives CSP
        directives:
            default-src: ["'self'"]
            script-src:
                [
                    "'self'",
                    "'unsafe-inline'",
                    "'unsafe-eval'",
                    "cdnjs.cloudflare.com",
                ]
            style-src: ["'self'", "'unsafe-inline'", "cdnjs.cloudflare.com"]
            img-src: ["'self'", "data:"]
            font-src: ["'self'"]
            frame-src: ["'self'"]
            connect-src: ["'self'"]
            report-uri: ["/csp-report"] # Ajouter report-uri comme directive
